# sha256 as of 2020-06-30 for node:10-alpine
FROM node@sha256:bafda8e474ba8973f146cb3fc2d531cf7fb7fec73ef4ca04aa38f26db520a883

# Install npm, making output less verbose
ARG NPM_VER=6.13.7
ENV NPM_CONFIG_LOGLEVEL warn
RUN npm install npm@${NPM_VER} -g

RUN apk add --no-cache paxctl python make g++
RUN paxctl -cm /usr/local/bin/node

ARG USERID
RUN adduser -D -g "" -u "${USERID}" docker_user || true
USER ${USERID}

CMD npm install && touch .node_complete && npm run start
